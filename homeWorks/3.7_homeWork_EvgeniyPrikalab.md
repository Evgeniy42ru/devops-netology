# Домашнее задание к занятию ["3.7. Компьютерные сети, лекция 2"](https://github.com/netology-code/sysadm-homeworks/tree/devsys10/03-sysadmin-07-net)

### 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

Ответ: 
- linux - "ip l" отоброзит включая виртуальные интерфейсы, или для удобства "ip -c -br l" -c подсветка, -br краткая информация
```
vagrant@vagrant:~$ ip l
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 08:00:27:b1:28:5d brd ff:ff:ff:ff:ff:ff

vagrant@vagrant:~$ ip -c -br l
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP> 
eth0             UP             08:00:27:b1:28:5d <BROADCAST,MULTICAST,UP,LOWER_UP> 
```
- windows "ipconfig /all"

### 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

Ответ:
- Протокол - LLDP
- Пакет - lldpd
- Установка - "sudo apt install lldpd"
- Включение - "systemctl enable lldpd && systemctl start lldpd"

### 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

Ответ:
- Технология - [VLAN](http://xgu.ru/wiki/VLAN_%D0%B2_Linux)
- Пакет vlan
- Пример конфига - /etc/network/interfaces.
```
auto vlan1400
iface vlan1400 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        vlan_raw_device eth0
```

### 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

Ответ:  
- LAG - агрегация портов, типы агрегации:
  - mode=0 (balance-rr)
Этот режим используется по-умолчанию, если в настройках не указано другое. balance-rr обеспечивает балансировку нагрузки и отказоустойчивость. В данном режиме пакеты отправляются "по кругу" от первого интерфейса к последнему и сначала. Если выходит из строя один из интерфейсов, пакеты отправляются на остальные оставшиеся.При подключении портов к разным коммутаторам, требует их настройки.

  - mode=1 (active-backup)
При active-backup один интерфейс работает в активном режиме, остальные в ожидающем. Если активный падает, управление передается одному из ожидающих. Не требует поддержки данной функциональности от коммутатора.

  - mode=2 (balance-xor)
Передача пакетов распределяется между объединенными интерфейсами по формуле ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.

  - mode=3 (broadcast)
Происходит передача во все объединенные интерфейсы, обеспечивая отказоустойчивость.

  - mode=4 (802.3ad)
Это динамическое объединение портов. В данном режиме можно получить значительное увеличение пропускной способности как входящего так и исходящего трафика, используя все объединенные интерфейсы. Требует поддержки режима от коммутатора, а так же (иногда) дополнительную настройку коммутатора.

  - mode=5 (balance-tlb)
Адаптивная балансировка нагрузки. При balance-tlb входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса. Обеспечивается отказоустойчивость и распределение нагрузки исходящего трафика. Не требует специальной поддержки коммутатора.

  - mode=6 (balance-alb)
Адаптивная балансировка нагрузки (более совершенная). Обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP). Не требует специальной поддержки коммутатором, но требует возможности изменять MAC-адрес устройства.

- пример конфига  "/etc/network/interfaces":
```
auto bond0

iface bond0 inet static
    address 10.31.1.5
    netmask 255.255.255.0
    network 10.31.1.0
    gateway 10.31.1.254
    bond-slaves eth0 eth1
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200
```

### 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

Ответ:
- Сколько IP адресов в сети с маской /29.
```
8, 2 в резерве, 6 адресов можно использовать.
```
- Сколько /29 подсетей можно получить из сети с маской /24.
```
/24 - 256 адресов
/29 - 8 адресов

256/8 = 32 подсети
```
- Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
```
10.10.10.1/29 - 10.10.10.8/29
10.10.10.9/29 - 10.10.10.16/29
10.10.10.17/29 - 10.10.10.24/29
10.10.10.25/29 - 10.10.10.32/29
```

### 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

Ответ:
- Можем использовать диапазон 100.64.0.0/10 - 100.127.255.255/10
- Маску /26 позволяет использовать 62 адреса
- 100.64.0.1/26 - 100.64.0.62/26, 2 в резерве 0 и 63

### 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

Ответ:
- windows
  - Проверить "arp -a"
  - Очистить кэш "arp -d"
  - Удалить "arp -d $ip-address"
- linux
  - Проверить "ip neigh"
  - Очистить кэш "ip neigh flush all"
  - Удалить "ip neigh del $ip-address lladdr $link-layer-address $device"
